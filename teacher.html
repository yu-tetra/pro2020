<html lang="ja">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="./CSS/style.css">
    <link rel="stylesheet" href="./CSS/content.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcutico" href="favicon.ico">
    <title>部屋制作</title>
</head>
<body>
    <h1>部屋制作</h1>

    <form>
        ユーザー名を登録<br>
        <input type="text" id="user" class="in" placeholder="例)〇〇先生"><br>

        <br>

        パスワードを設定<br>
        <input type="text" id="pass" class="in" placeholder="半角英数8文字以上">
    </form>

    <button class="btn btn-primary btn-lg" id="submit">制作する</button>


    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.5.2/firebase-firestore.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

    <script> 
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyBpmypIXLxfFpHxcAWRnF2vQB_ONU6OISA",
            authDomain: "project2020-93dda.firebaseapp.com",
            databaseURL: "https://project2020-93dda.firebaseio.com",
            projectId: "project2020-93dda",
            storageBucket: "project2020-93dda.appspot.com",
            messagingSenderId: "453159572734",
            appId: "1:453159572734:web:e3f6b15cb3bb4b1b9401af"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        var db = firebase.firestore();
        var placep = db.collection("rooms")
        
        $('#submit').on('click',function(){
            var name = $('#user').val();
            var pass = $('#pass').val();

            if(!name || !pass){
                alert("入力されていない項目があります。");
            }else{
            placep.add({
                password: pass
            })
            .then(function(docRef) {
                var roomid = docRef.id;
                console.log(roomid);
                var placen = db.collection("rooms").doc(roomid).collection("member");
                placen.add({
                name: name
                });
                document.cookie = "id="+encodeURIComponent(roomid);
                document.cookie = "name="+name;
                location.href="teacher_login.html";
            }); 
        };
        });
    </script>
    
</body>
</html>